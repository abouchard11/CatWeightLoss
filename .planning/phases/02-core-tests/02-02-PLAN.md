---
phase: 02-core-tests
plan: 02
type: execute
---

<objective>
Add unit tests for Cat model computed properties.

Purpose: Ensure weight trend algorithm and progress calculations are correct.
Output: CatModelTests.swift with tests for weightTrend and progressPercentage.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-phase.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@CatWeightLoss/Models/Cat.swift
@CatWeightLoss/Models/WeightEntry.swift

**Current state:** PortionCalculator tests exist from 02-01
**Challenge:** Cat uses SwiftData @Model, need to test without ModelContext
**Pattern:** Create Cat instance, manually set weightEntries array
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create CatModelTests.swift</name>
  <files>CatWeightLossTests/CatModelTests.swift</files>
  <action>
Create test file for Cat computed properties:

1. **progressPercentage Tests**
   - Start 12, target 10, current 11 → 50% progress
   - Start 12, target 10, current 10 → 100% progress
   - Start 12, target 10, current 12 → 0% progress
   - Start 12, target 12 (no loss needed) → 100%
   - Edge: current below target → capped at 100%

2. **weightTrend Tests**
   - Fewer than 3 entries → .insufficient
   - 3+ entries, recent avg < older avg by 0.1+ → .decreasing
   - 3+ entries, recent avg > older avg by 0.1+ → .increasing
   - 3+ entries, difference < 0.1 → .stable
   - 5 entries testing exact algorithm

Create helper to build Cat with specific weight entries.
Use Calendar.current to create dated entries.
  </action>
  <verify>xcodebuild -project CatWeightLoss.xcodeproj -scheme CatWeightLossTests -destination 'platform=iOS Simulator,name=iPhone 17' test</verify>
  <done>All Cat model tests pass</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] CatModelTests.swift exists
- [ ] All tests pass (xcodebuild test succeeds)
- [ ] progressPercentage edge cases covered
- [ ] weightTrend algorithm verified
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Weight tracking logic has test coverage
</success_criteria>

<output>
After completion, create `.planning/phases/02-core-tests/02-02-SUMMARY.md`
</output>
